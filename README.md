# DetailViewer

## Обзор Проекта

**DetailViewer** — это модульное настольное приложение на базе WPF (.NET 8.0), разработанное для эффективного управления и просмотра данных, связанных с технической документацией, в частности, с децимальными номерами ЕСКД. Приложение поддерживает чтение и запись данных как из локальных файлов Microsoft Excel, так и из Google Таблиц, предоставляя гибкие возможности для работы с данными.

### Ключевые Особенности:
*   **Управление Документами:** Чтение, отображение и запись структурированных записей документов, включая децимальные номера ЕСКД, коды классификаторов ЯСТ, наименования, а также информацию о сборках и изделиях.
*   **Поддержка Источников Данных:** Интеграция с файлами Excel (.xlsx) через библиотеку EPPlus и с Google Таблицами через Google Sheets API.
*   **Модульная Архитектура:** Построено на фреймворке Prism, что обеспечивает высокую расширяемость, поддерживаемость и возможность независимой разработки модулей.
*   **Шаблон MVVM:** Использование шаблона Model-View-ViewModel для чистого разделения логики представления и бизнес-логики, упрощая разработку и тестирование пользовательского интерфейса.
*   **Внедрение Зависимостей:** Использование контейнера Unity для управления зависимостями, что повышает гибкость и тестируемость кода.

## Начало Работы (Использование)

### Требования
*   **Visual Studio 2022** (или новее) с установленной рабочей нагрузкой "Разработка классических приложений .NET".
*   **.NET 8.0 SDK**.

### Сборка и Запуск
1.  **Клонируйте репозиторий:**
    ```bash
    git clone <URL_ВАШЕГО_РЕПОЗИТОРИЯ>
    cd DetailViewer
    ```
2.  **Откройте решение:**
    Откройте файл `DetailViewer.sln` в Visual Studio.
3.  **Восстановите пакеты NuGet:**
    Visual Studio должен автоматически восстановить все необходимые пакеты NuGet. Если нет, щелкните правой кнопкой мыши по решению в "Обозревателе решений" и выберите "Восстановить пакеты NuGet".
4.  **Соберите решение:**
    В меню Visual Studio выберите `Сборка` -> `Собрать решение`.
5.  **Запустите приложение:**
    Нажмите `F5` или кнопку `Пуск` в Visual Studio, чтобы запустить приложение.

### Конфигурация Google Таблиц (Опционально)
Если вы планируете использовать Google Таблицы в качестве источника данных, вам необходимо настроить учетные данные Google API:
1.  Перейдите в [Google Cloud Console](https://console.cloud.google.com/).
2.  Создайте новый проект или выберите существующий.
3.  Включите `Google Sheets API` для вашего проекта.
4.  Создайте учетные данные типа `Учетная запись службы` (Service Account) или `Идентификатор клиента OAuth 2.0` (OAuth 2.0 Client ID) в зависимости от ваших потребностей аутентификации.
5.  Загрузите файл JSON с учетными данными.
6.  Укажите путь к этому файлу JSON в конструкторе `GoogleSheetsDocumentDataService` или через конфигурацию приложения (если такая предусмотрена). В текущей реализации, путь к файлу учетных данных передается в конструктор `GoogleSheetsDocumentDataService`.

## Структура Проекта и Внедрение

Проект организован в виде модульного решения Prism, состоящего из нескольких подпроектов:

*   **`DetailViewer`**: Основной исполняемый проект WPF. Содержит главную оболочку приложения (`MainWindow`) и отвечает за инициализацию фреймворка Prism и загрузку модулей.
*   **`DetailViewer.Core`**: Содержит основные интерфейсы, модели данных и сервисы, используемые во всем приложении. Здесь определены `IDocumentDataService`, `ExcelDocumentDataService`, `GoogleSheetsDocumentDataService`, а также модели `DocumentRecord`, `ESKDNumber` и `Classifier`.
*   **`DetailViewer.Global`**: Предназначен для общих ресурсов, утилит или глобальных конфигураций, доступных для всех модулей.
*   **`DetailViewer.Modules.Dialogs`**: Модуль Prism, отвечающий за реализацию и управление различными диалоговыми окнами в приложении.
*   **`DetailViewer.Modules.Explorer`**: Модуль Prism, предоставляющий функциональность, связанную с просмотром файлов, навигацией по каталогам или выбором файлов/папок.

### Архитектурные Паттерны
*   **MVVM (Model-View-ViewModel):** Используется для разделения обязанностей, что делает код более чистым, тестируемым и поддерживаемым.
*   **Prism Framework:** Обеспечивает модульность, позволяя разрабатывать и развертывать части приложения независимо. Он также предоставляет инфраструктуру для навигации, управления событиями и внедрения зависимостей.
*   **Внедрение Зависимостей (DI):** Используется контейнер Unity для разрешения зависимостей, что способствует слабой связанности компонентов.

### Добавление Новых Модулей/Функций
Для добавления новой функциональности рекомендуется создавать новый модуль Prism:
1.  Создайте новый проект библиотеки классов (.NET) в решении.
2.  Установите пакеты `Prism.Core`, `Prism.Wpf` и `Prism.Unity` (или другой контейнер DI, если вы не используете Unity).
3.  Создайте класс, реализующий `IModule` (например, `MyNewModule.cs`).
4.  Реализуйте методы `OnInitialized` и `RegisterTypes` для регистрации ваших представлений, ViewModels и сервисов.
5.  Добавьте новый модуль в `ConfigureModuleCatalog` в `App.xaml.cs` основного проекта `DetailViewer`.
6.  Добавьте ссылку на новый проект модуля в основной проект `DetailViewer`.

### Разработка и Тестирование
*   Придерживайтесь принципов MVVM при разработке новых функций.
*   Используйте внедрение зависимостей для облегчения модульного тестирования.
*   Убедитесь, что все изменения соответствуют существующим стандартам кодирования и архитектурным паттернам.

## Roadmap

Для отслеживания прогресса и планирования будущих задач, пожалуйста, обращайтесь к [GitHub Issues](https://github.com/AlexeyDevTech/DetailViewer/issues) и [GitHub Projects/Kanban Board](https://github.com/AlexeyDevTech/DetailViewer/projects) (если настроено).

Ниже представлен список ключевых задач, которые предстоит выполнить для завершения проекта и его дальнейшего развития:

### Основные Задачи:
*   **Реализация полноценного UI для отображения и редактирования `DocumentRecord`:**
    *   Создание представлений (Views) для отображения списка документов.
    *   Разработка ViewModel для управления данными и взаимодействием с UI.
    *   Реализация форм для добавления/редактирования отдельных записей `DocumentRecord`.
*   **Интеграция с модулями `Dialogs` и `Explorer`:**
    *   Использование модуля `Dialogs` для отображения сообщений, подтверждений и форм ввода данных.
    *   Использование модуля `Explorer` для выбора файлов Excel или указания путей для сохранения.
*   **Улучшение обработки ошибок и валидации:**
    *   Добавление более надежной обработки ошибок при чтении/записи данных (как Excel, так и Google Sheets).
    *   Реализация валидации данных для `DocumentRecord` и `ESKDNumber`.
*   **Оптимизация производительности:**
    *   Для больших объемов данных, рассмотреть асинхронные операции и фоновую обработку.
*   **Тестирование:**
    *   Написание модульных и интеграционных тестов для ключевых компонентов (`IDocumentDataService`, `ExcelDocumentDataService`, `GoogleSheetsDocumentDataService`, ViewModels).

### Дополнительные Задачи (Будущие Улучшения):
*   **Поиск и фильтрация:** Реализация функциональности поиска и фильтрации записей документов по различным критериям.
*   **Экспорт данных:** Возможность экспорта данных в другие форматы (например, CSV, PDF).
*   **Настройки пользователя:** Добавление пользовательских настроек (например, путь по умолчанию для файлов Excel, учетные данные Google Sheets).
*   **Логирование:** Внедрение системы логирования для отслеживания ошибок и поведения приложения.
*   **Интернационализация (i18n):** Поддержка нескольких языков интерфейса.
*   **Улучшение UX/UI:** Доработка пользовательского интерфейса для повышения удобства использования и визуальной привлекательности.
*   **CI/CD:** Настройка конвейера непрерывной интеграции/непрерывной доставки для автоматизации сборки и развертывания.